#!/usr/bin/env bash

transactionBatch='{
  "version": "1.0",
  "chainId": "100",
  "createdAt": 1714653878777,
  "meta": {
    "name": "Transactions Batch",
    "description": "",
    "txBuilderVersion": "1.16.5",
    "createdFromSafeAddress": "0x5112D584a1C72Fc250176B57aEba5fFbbB287D8F",
    "createdFromOwnerAddress": ""
  },
  "transactions": [ __BATCH__ ]
}'

transactionTemplate='
    {
      "to": "0x9d494768936b6bDaabc46733b8D53A937A6c6D7e",
      "value": "0",
      "data": "__CALLDATA__",
      "contractMethod": {
        "inputs": [],
        "name": "fallback",
        "payable": true
      },
      "contractInputsValues": null
    }
'

transactions=''

function addTransaction {
  local callData=$1
  if [ -n "$transactions" ]; then
      transactions="$transactions,"
  fi
  transactions="$transactions$(echo $transactionTemplate | sed "s|__CALLDATA__|$callData|")"
}

addTransaction $(cast calldata "setPolicy(uint256,string)" 12 /ipfs/QmXW1MKX2NegMgHrYACkcpeKES45zGpXfWaYA1q4M3cx3W/xDai-Development-Court-Policy-v2.json)
#0xf00adf5e000000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005a2f697066732f516d5857314d4b58324e65674d6748725941436b6370654b455334357a47705866576159413171344d33637833572f784461692d446576656c6f706d656e742d436f7572742d506f6c6963792d76322e6a736f6e000000000000

addTransaction $(cast calldata "setPolicy(uint256,string)" 13 /ipfs/QmXW1MKX2NegMgHrYACkcpeKES45zGpXfWaYA1q4M3cx3W/xDai-Solidity-Court-Policy-v2.json)
#0xf00adf5e000000000000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000572f697066732f516d5857314d4b58324e65674d6748725941436b6370654b455334357a47705866576159413171344d33637833572f784461692d536f6c69646974792d436f7572742d506f6c6963792d76322e6a736f6e000000000000000000

addTransaction $(cast calldata "setPolicy(uint256,string)" 14 /ipfs/QmXW1MKX2NegMgHrYACkcpeKES45zGpXfWaYA1q4M3cx3W/xDai-Javascript-Court-Policy-v2.json)
#0xf00adf5e000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000592f697066732f516d5857314d4b58324e65674d6748725941436b6370654b455334357a47705866576159413171344d33637833572f784461692d4a6176617363726970742d436f7572742d506f6c6963792d76322e6a736f6e00000000000000

# echo "[$transactions]"
echo "$transactionBatch" | sed "s|__BATCH__|$transactions|"
